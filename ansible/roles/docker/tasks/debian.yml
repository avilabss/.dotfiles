---
- name: Check if Docker is installed
  ansible.builtin.command: which docker
  register: docker_check
  changed_when: false
  failed_when: false

- name: Install Docker via convenience script
  ansible.builtin.shell: curl -fsSL https://get.docker.com | sh
  become: true
  when: docker_check.rc != 0

- name: Add user to docker group
  ansible.builtin.user:
    name: "{{ dotfiles_user }}"
    groups: docker
    append: true
  become: true
